<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>3D Runner – Neu & Funktionierend</title>
<style>
  html,body{margin:0;padding:0;height:100%;background:#0a0f15;color:#fff;font-family:Arial,Helvetica,sans-serif}
  #game{width:100%;height:100vh;overflow:hidden;position:relative}
  #hud{position:absolute;left:10px;top:10px;padding:8px 12px;background:rgba(0,0,0,0.4);border-radius:6px;z-index:5}
  #overlay{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);padding:20px;background:rgba(0,0,0,0.7);border-radius:10px;text-align:center;z-index:10}
  button{padding:10px 18px;border-radius:8px;border:none;background:#1a2330;color:#fff;font-size:16px;cursor:pointer}
</style>
</head>
<body>
<div id="game"></div>
<div id="hud">Punkte: <span id="score">0</span></div>
<div id="overlay"><h2>3D Runner</h2><p>A/D bewegen – Leertaste springen</p><button id="start">Start</button></div>

<script src="https://unpkg.com/three@0.152.2/build/three.min.js"></script>
<script>
let scene,camera,renderer,player,obstacles=[],running=false,score=0;
let lanes=[-2,0,2],currentLane=1;
let velocityY=0,gravity=-1.2,onGround=true,jumpStrength=4;

function init(){
  scene=new THREE.Scene();
  camera=new THREE.PerspectiveCamera(70,innerWidth/innerHeight,0.1,200);
  camera.position.set(0,5,12);

  renderer=new THREE.WebGLRenderer({antialias:true});
  renderer.setSize(innerWidth,innerHeight);
  document.getElementById('game').appendChild(renderer.domElement);

  const light=new THREE.DirectionalLight(0xffffff,1);
  light.position.set(5,10,5);
  scene.add(light);

  const ground=new THREE.Mesh(new THREE.PlaneGeometry(20,500),new THREE.MeshStandardMaterial({color:0x111922}));
  ground.rotation.x=-Math.PI/2;
  scene.add(ground);

  player=new THREE.Mesh(new THREE.BoxGeometry(1,2,1),new THREE.MeshStandardMaterial({color:0xff4444}));
  player.position.set(0,1,0);
  scene.add(player);

  for(let i=1;i<8;i++) spawn(-i*20);

  window.addEventListener('keydown',controls);
  animate();
}

function controls(e){
  if(!running) return;
  if(e.code==='KeyA') currentLane=Math.max(0,currentLane-1);
  if(e.code==='KeyD') currentLane=Math.min(2,currentLane+1);
  if(e.code==='Space' && onGround){ velocityY=jumpStrength; onGround=false; }
}

function spawn(z){
  const o=new THREE.Mesh(new THREE.BoxGeometry(1.5,1.5,1.5),new THREE.MeshStandardMaterial({color:0x55aaff}));
  o.position.set(lanes[Math.floor(Math.random()*3)],1,z);
  scene.add(o);
  obstacles.push(o);
}

function reset(){
  obstacles.forEach(o=>scene.remove(o));
  obstacles=[];
  for(let i=1;i<8;i++) spawn(-i*20);
  score=0;
  currentLane=1;
  player.position.set(0,1,0);
  velocityY=0;
  onGround=true;
  running=true;
}

function animate(){
  requestAnimationFrame(animate);

  if(running){
    player.position.x += (lanes[currentLane]-player.position.x)*0.2;

    velocityY += gravity*0.1;
    player.position.y += velocityY*0.1;
    if(player.position.y<=1){player.position.y=1;velocityY=0;onGround=true;}

    obstacles.forEach((o,i)=>{
      o.position.z += 1;
      if(o.position.z>10){scene.remove(o);obstacles.splice(i,1);spawn(-150);score++;}
      if(Math.abs(o.position.z-player.position.z)<1.5 && Math.abs(o.position.x-player.position.x)<1.2 && player.position.y<1.4){running=false;document.getElementById('overlay').style.display='block';}
    });

    document.getElementById('score').textContent=score;
  }

  renderer.render(scene,camera);
}

document.getElementById('start').onclick=()=>{
  document.getElementById('overlay').style.display='none';
  reset();
};

init();
</script>
</body>
</html>
